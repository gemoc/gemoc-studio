<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <title>4.2.&nbsp;DSA definition</title><link rel="stylesheet" href="css/docbook.css" type="text/css"><meta name="generator" content="DocBook XSL-NS Stylesheets V1.75.2"><link rel="home" href="Tutorial_SigPML.html" title="SigPML overview"><link rel="up" href="ch04.html" title="Chapter&nbsp;4.&nbsp;SigPML execution semantics"><link rel="prev" href="ch04.html" title="Chapter&nbsp;4.&nbsp;SigPML execution semantics"><link rel="next" href="ch04s03.html" title="4.3.&nbsp;MoCCML definition"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">4.2.&nbsp;DSA definition</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch04.html">Prev</a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;4.&nbsp;SigPML execution semantics</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="ch04s03.html">Next</a></td></tr></table><hr></div><div class="section" title="4.2.&nbsp;DSA definition"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_dsa_definition"></a>4.2.&nbsp;DSA definition</h2></div></div></div><p>The DSA definition includes two steps :
- adding Execution Data and Execution Function in the Ecore model.
- creating aspects to weave with the Ecore model in Kermeta3</p><div class="section" title="4.2.1.&nbsp;Extending the Ecore definition"><div class="titlepage"><div><div><h3 class="title"><a name="_extending_the_ecore_definition"></a>4.2.1.&nbsp;Extending the Ecore definition</h3></div></div></div><p>So first, Execution Data and Execution Function definitions are added to the domain model of SigPMLTuto ecore file. We extend the SigPML metamodel by adding one function <span class="emphasis"><em>execute()</em></span> and two varaiables <span class="emphasis"><em>cycles</em></span> and <span class="emphasis"><em>currentExecCycle</em></span> in the <span class="emphasis"><em>Block</em></span> class.
So the block instances run the function <span class="emphasis"><em>execute()</em></span> when the value of <span class="emphasis"><em>currentExecCycle</em></span> is lower than the value of <span class="emphasis"><em>cycles</em></span>.</p><p>The function and variables are added with the Ecore reflexive editor. In this tutorial, function and variables are provided in the initial ecore model.</p><p title="Execution Function in the SigPML metamodel"><b>Execution Function in the SigPML metamodel.&nbsp;</b><span class="inlinemediaobject"><img src="./SigPML/images/sigpml/EF_InEcoreDomainModel.png" alt="Execution Function in the SigPML metamodel"></span></p></div><div class="section" title="4.2.2.&nbsp;Creating the DSA project"><div class="titlepage"><div><div><h3 class="title"><a name="_creating_the_dsa_project"></a>4.2.2.&nbsp;Creating the DSA project</h3></div></div></div><p>The creation of the DSA project is on a click right menu on the Melange file "Create DSA Project for language "&#8594;select the name of the xDSML language (SigPMLTuto language).</p><p title="DSA project creation"><b>DSA project creation.&nbsp;</b><span class="inlinemediaobject"><img src="./SigPML/images/sigpml/CreateDSAProject.png" alt="DSA project creation"></span></p><p>This project includes aspect definition which is weaved with the Java code corresponding the SigPML ecore model. The file name and classes suffix are proposed in the DSA wizard of the next figure.</p><p title="DSA project wizard"><b>DSA project wizard.&nbsp;</b><span class="inlinemediaobject"><img src="./SigPML/images/sigpml/DSA-Wizard.png" alt="DSA project wizard"></span></p><p>The resulted DSA project is a k3dsa project with a sigpmlAspects.xtend file in the package <span class="emphasis"><em>org.gemoc.sample.xsigpml.k3dsa</em></span>.
This file contains the aspects that we want to add to the necessary classes in our case only the <span class="emphasis"><em>Block</em></span> one. The resulting project is showed in the next figure.</p><p title="K3dsa project with the aspect code provided in the next section"><b>K3dsa project with the aspect code provided in the next section.&nbsp;</b><span class="inlinemediaobject"><img src="./SigPML/images/sigpml/resultedDSAProject.png" alt="DSA project and associated aspect file"></span></p></div><div class="section" title="4.2.3.&nbsp;Implementation of the DSA"><div class="titlepage"><div><div><h3 class="title"><a name="_implementation_of_the_dsa"></a>4.2.3.&nbsp;Implementation of the DSA</h3></div></div></div><p>In this tutorial, the implementation of the functions is simple. The <span class="emphasis"><em>execute</em></span> function increments the <span class="emphasis"><em>currentExecCycle</em></span> of a block until its value is inferior to the <span class="emphasis"><em>cycles</em></span> value.</p><p>The source code is available through
<a class="link" href="SigPML/files/sigpmlAspects.xtend" target="_top">Kermeta 3 aspects,tabsize=4</a>
and showed below</p><pre class="screen">package sigpml.aspects

import fr.inria.diverse.k3.al.annotationprocessor.Aspect
import sigpml.Application
import sigpml.Block
import sigpml.Connector


@Aspect(className=Application)
class ApplicationAspect {


}


@Aspect(className=Block)
class BlockAspect {

	public int currentExecCycle = 0


	def public void execute() {

		if ( _self.currentExecCycle &lt; _self.cycles )
			_self.currentExecCycle = _self.currentExecCycle + 1
		else
		_self.currentExecCycle = 0

		println(_self.name + "\n      execute (" + _self.currentExecCycle + ")" )


}





}


@Aspect(className=Connector)
class ConnectorAspect {


}</pre><p>You must remove the aspects reference in the Melange file.</p><p><span class="inlinemediaobject"><img src="./SigPML/images/sigpml/RemovingImportAspectInMelange.png" alt="Updating the Melange file"></span></p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch04.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="ch04.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="ch04s03.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;4.&nbsp;SigPML execution semantics&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="Tutorial_SigPML.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;4.3.&nbsp;MoCCML definition</td></tr></table></div></body></html>