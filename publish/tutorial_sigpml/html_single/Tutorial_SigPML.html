<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>SigPML overview</title><link rel="stylesheet" href="css/docbook.css" type="text/css"><meta name="generator" content="DocBook XSL-NS Stylesheets V1.75.2"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div lang="en" class="book" title="SigPML overview"><div class="titlepage"><div><div><h1 class="title"><a name="d0e3"></a>SigPML overview</h1></div></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="chapter"><a href="#_sigpml_overview">1. SigPML overview</a></span></dt><dt><span class="chapter"><a href="#_import_and_install_the_projects_for_the_abstract_and_concrete_syntax">2. Import and install the projects for the abstract and concrete syntax</a></span></dt><dd><dl><dt><span class="section"><a href="#_abstract_and_concrete_syntax_of_the_sigpml_language_projects">2.1. Abstract and concrete syntax of the SigPML language projects</a></span></dt><dt><span class="section"><a href="#_sigpml_abstract_syntax">2.2. SigPML abstract syntax</a></span></dt><dt><span class="section"><a href="#_sigpml_concrete_syntax_and_sample_model">2.3. SigPML concrete syntax and sample model</a></span></dt></dl></dd><dt><span class="chapter"><a href="#_creating_an_xdsml_project">3. Creating an xDSML Project</a></span></dt><dd><dl><dt><span class="section"><a href="#_open_xdsml_root_definition">3.1. Open xDSML root definition</a></span></dt></dl></dd><dt><span class="chapter"><a href="#_sigpml_execution_semantics">4. SigPML execution semantics</a></span></dt><dd><dl><dt><span class="section"><a href="#_execution_semantics_overview">4.1. Execution semantics overview</a></span></dt><dt><span class="section"><a href="#_dsa_definition">4.2. DSA definition</a></span></dt><dd><dl><dt><span class="section"><a href="#_extending_the_ecore_definition">4.2.1. Extending the Ecore definition</a></span></dt><dt><span class="section"><a href="#_creating_the_dsa_project">4.2.2. Creating the DSA project</a></span></dt><dt><span class="section"><a href="#_implementation_of_the_dsa">4.2.3. Implementation of the DSA</a></span></dt></dl></dd><dt><span class="section"><a href="#_moccml_definition">4.3. MoCCML definition</a></span></dt><dd><dl><dt><span class="section"><a href="#_creating_the_moccml_project">4.3.1. Creating the MoCCML project</a></span></dt><dt><span class="section"><a href="#_implementation_of_the_moccml">4.3.2. Implementation of the MoCCML</a></span></dt></dl></dd><dt><span class="section"><a href="#_dse_definition">4.4. DSE definition</a></span></dt><dd><dl><dt><span class="section"><a href="#_creating_the_ecl_project">4.4.1. Creating the ECL project</a></span></dt><dt><span class="section"><a href="#_implementation_of_the_ecl">4.4.2. Implementation of the ECL</a></span></dt></dl></dd><dt><span class="section"><a href="#_create_an_animator">4.5. Create an animator</a></span></dt><dd><dl><dt><span class="section"><a href="#_creating_the_animator_project_as_a_sirius_viewpoint">4.5.1. Creating the Animator project as a Sirius viewpoint</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#_sigpml_modeling_workbench">5. SigPML modeling workbench</a></span></dt><dd><dl><dt><span class="section"><a href="#_launch_the_modeling_workbench_creation_start_a_new_eclipse">5.1. Launch the Modeling workbench creation (Start a new Eclipse)</a></span></dt><dt><span class="section"><a href="#_import_the_project_with_a_sample_model">5.2. Import the project with a sample model</a></span></dt><dt><span class="section"><a href="#_create_a_debug_launch_configuration">5.3. Create a debug launch configuration</a></span></dt><dt><span class="section"><a href="#_start_the_model">5.4. Start the model</a></span></dt><dt><span class="section"><a href="#_select_a_logical_step">5.5. Select a logical step</a></span></dt><dt><span class="section"><a href="#_select_a_logical_step_in_the_past">5.6. Select a logical step in the past</a></span></dt><dt><span class="section"><a href="#_stop_the_animation">5.7. Stop the animation</a></span></dt><dt><span class="section"><a href="#_this_is_the_end">5.8. This is the end</a></span></dt></dl></dd></dl></div><div class="chapter" title="Chapter&nbsp;1.&nbsp;SigPML overview"><div class="titlepage"><div><div><h2 class="title"><a name="_sigpml_overview"></a>Chapter&nbsp;1.&nbsp;SigPML overview</h2></div></div></div><p>SigPML is a Domain Specific Modeling Language dedicated to data flow processing.
The concrete syntax is based on blocks, ports and connectors which associated ports to create directed flows.
The DSML execution semantics defines that all the blocks of a model run concurrently regarding constraints on connector synchronization.
The tutorial includes two execution semantics with the first one which defines a synchronization of the block execution with the pop and push actions of the connectors.
The second one introduces read and write operations in the block semantics to decouple the connector access.</p><p>The final result of the SigPML model execution is showed on the next picture with a purple processing block which is an executing block and the brown block waits for a connector synchronization after its connector acces.</p><p><span class="inlinemediaobject"><img src="./SigPML/images/sigpml/OverviewExecuteSigpmlModelWithVCD.png" alt="Execution of a SigPML model"></span></p></div><div class="chapter" title="Chapter&nbsp;2.&nbsp;Import and install the projects for the abstract and concrete syntax"><div class="titlepage"><div><div><h2 class="title"><a name="_import_and_install_the_projects_for_the_abstract_and_concrete_syntax"></a>Chapter&nbsp;2.&nbsp;Import and install the projects for the abstract and concrete syntax</h2></div></div></div><div class="section" title="2.1.&nbsp;Abstract and concrete syntax of the SigPML language projects"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_abstract_and_concrete_syntax_of_the_sigpml_language_projects"></a>2.1.&nbsp;Abstract and concrete syntax of the SigPML language projects</h2></div></div></div><p>The abstract and the concrete syntax of SigPML language projects are provided as two archive files to download and extract in your file system.</p><p>The abstract syntax is given through a Ecore project <a class="link" href="SigPML/files/language.zip" target="_top">The Ecore project</a>.
Or, you can create an Ecore project with the provided <a class="link" href="SigPML/files/sigpmldomain.ecore" target="_top">Ecore file</a>.</p><p>The graphical concrete syntax is defined with the Sirius component. We provide a Sirius project as a zip file.
You can also make your own Sirius project and use the online <a class="link" href="https://wiki.eclipse.org/Sirius/Tutorials/4MinTutorial#Overview" target="_top">Sirius tutorial</a> and the online <a class="link" href="http://www.eclipse.org/sirius/doc/" target="_top">Sirius Documentation</a>.</p><p>The graphical editor model is given through a Sirius project as the graphical  syntax of your DSML <a class="link" href="SigPML/files/org.gemoc.SigpmlTuto.design.zip" target="_top">The Sirius project</a>.</p><p>Or you can create a Sirius project with the provided odesign file <a class="link" href="SigPML/files/sigpmlTuto.odesign" target="_top">The odesign file</a>.</p></div><div class="section" title="2.2.&nbsp;SigPML abstract syntax"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_sigpml_abstract_syntax"></a>2.2.&nbsp;SigPML abstract syntax</h2></div></div></div><p>This language is based on the Ecore metamodel presented in the next figure.</p><p><span class="inlinemediaobject"><img src="./SigPML/images/sigpml/sigpmldomainEcore.png" alt="SigPML metamodel"></span></p><p>A SigPML Application consists of a set of Blocks and a set of Connectors which are in relation with the blocks through input and output ports.
The Connector concept owns the capacity attribute which defines the maximum number of access on the connector, and the currentSize attribute provides the current access number on the connector.
The Port contains the rate attribute which defines the possible access number input and output ports.</p></div><div class="section" title="2.3.&nbsp;SigPML concrete syntax and sample model"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_sigpml_concrete_syntax_and_sample_model"></a>2.3.&nbsp;SigPML concrete syntax and sample model</h2></div></div></div><p>With the provided project, the final result of the modeling tool is showed in the next figure.</p><p title="SigPML final animation modeling tool"><b>SigPML final animation modeling tool.&nbsp;</b><span class="inlinemediaobject"><img src="./SigPML/images/sigpml/sigpmlModelEditor.png" alt="SigPML modeling tool"></span></p></div></div><div class="chapter" title="Chapter&nbsp;3.&nbsp;Creating an xDSML Project"><div class="titlepage"><div><div><h2 class="title"><a name="_creating_an_xdsml_project"></a>Chapter&nbsp;3.&nbsp;Creating an xDSML Project</h2></div></div></div><p>First, start by creating a new xDSML project (<span class="emphasis"><em>New &gt; Project &gt; GEMOC
Gemoc Concurrent / Gemoc Concurrent xDSML Project</em></span>), with your desired name, for instance
"org.gemoc.sample.SigpmlTuto". The next figure illustrates the xDSML wizard with the reference to the ecore project which containts the ecore model. The two others projects will be created next in the tutorial.</p><p title="xDSML wizard definition"><b>xDSML wizard definition.&nbsp;</b><span class="inlinemediaobject"><img src="./SigPML/images/sigpml/xDSMLProjectWindow.png" alt="xDSML wizard with all the constituents"></span></p><p>The wizard creates a Melange project as the root project of our xDSML to aggregate all the definitions of the composite parts.</p><div class="section" title="3.1.&nbsp;Open xDSML root definition"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_open_xdsml_root_definition"></a>3.1.&nbsp;Open xDSML root definition</h2></div></div></div><p>The result of the xDSML is a project inclunding the Melange file. The Melange file defines a language including a reference on the abstract syntax ecore model.</p><p title="The Melange file result"><a name="img-SigpmlMelangeFile"></a><b>The Melange file result.&nbsp;</b><span class="inlinemediaobject"><img src="./SigPML/images/sigpml/SigpmlMelangeFile.png" alt="Domain model selection"></span></p></div></div><div class="chapter" title="Chapter&nbsp;4.&nbsp;SigPML execution semantics"><div class="titlepage"><div><div><h2 class="title"><a name="_sigpml_execution_semantics"></a>Chapter&nbsp;4.&nbsp;SigPML execution semantics</h2></div></div></div><div class="section" title="4.1.&nbsp;Execution semantics overview"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_execution_semantics_overview"></a>4.1.&nbsp;Execution semantics overview</h2></div></div></div><p>The execution semantics of the xDSML must define that all the model blocks run concurrently.
The block execution is constrained by the access on the connectors associated with the block through input and output ports.
So an execute function of the blocks is synchronized on the connector behavior.</p><p>The rate to acces to the connector is defined as an attribute of the ports called <span class="emphasis"><em>rate</em></span>.</p><p>So we must define:
- the Execution Data (ED) and Execution Function (EF) into the DSA definition
- the MoCC with a MoCCML model
- the mapping between the MoCC and the DSA (ED and EF)</p></div><div class="section" title="4.2.&nbsp;DSA definition"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_dsa_definition"></a>4.2.&nbsp;DSA definition</h2></div></div></div><p>The DSA definition includes two steps :
- adding Execution Data and Execution Function in the Ecore model.
- creating aspects to weave with the Ecore model in Kermeta3</p><div class="section" title="4.2.1.&nbsp;Extending the Ecore definition"><div class="titlepage"><div><div><h3 class="title"><a name="_extending_the_ecore_definition"></a>4.2.1.&nbsp;Extending the Ecore definition</h3></div></div></div><p>So first, Execution Data and Execution Function definitions are added to the domain model of SigPMLTuto ecore file. We extend the SigPML metamodel by adding one function <span class="emphasis"><em>execute()</em></span> and two varaiables <span class="emphasis"><em>cycles</em></span> and <span class="emphasis"><em>currentExecCycle</em></span> in the <span class="emphasis"><em>Block</em></span> class.
So the block instances run the function <span class="emphasis"><em>execute()</em></span> when the value of <span class="emphasis"><em>currentExecCycle</em></span> is lower than the value of <span class="emphasis"><em>cycles</em></span>.</p><p>The function and variables are added with the Ecore reflexive editor. In this tutorial, function and variables are provided in the initial ecore model.</p><p title="Execution Function in the SigPML metamodel"><b>Execution Function in the SigPML metamodel.&nbsp;</b><span class="inlinemediaobject"><img src="./SigPML/images/sigpml/EF_InEcoreDomainModel.png" alt="Execution Function in the SigPML metamodel"></span></p></div><div class="section" title="4.2.2.&nbsp;Creating the DSA project"><div class="titlepage"><div><div><h3 class="title"><a name="_creating_the_dsa_project"></a>4.2.2.&nbsp;Creating the DSA project</h3></div></div></div><p>The creation of the DSA project is on a click right menu on the Melange file "Create DSA Project for language "&#8594;select the name of the xDSML language (SigPMLTuto language).</p><p title="DSA project creation"><b>DSA project creation.&nbsp;</b><span class="inlinemediaobject"><img src="./SigPML/images/sigpml/CreateDSAProject.png" alt="DSA project creation"></span></p><p>This project includes aspect definition which is weaved with the Java code corresponding the SigPML ecore model. The file name and classes suffix are proposed in the DSA wizard of the next figure.</p><p title="DSA project wizard"><b>DSA project wizard.&nbsp;</b><span class="inlinemediaobject"><img src="./SigPML/images/sigpml/DSA-Wizard.png" alt="DSA project wizard"></span></p><p>The resulted DSA project is a k3dsa project with a sigpmlAspects.xtend file in the package <span class="emphasis"><em>org.gemoc.sample.xsigpml.k3dsa</em></span>.
This file contains the aspects that we want to add to the necessary classes in our case only the <span class="emphasis"><em>Block</em></span> one. The resulting project is showed in the next figure.</p><p title="K3dsa project with the aspect code provided in the next section"><b>K3dsa project with the aspect code provided in the next section.&nbsp;</b><span class="inlinemediaobject"><img src="./SigPML/images/sigpml/resultedDSAProject.png" alt="DSA project and associated aspect file"></span></p></div><div class="section" title="4.2.3.&nbsp;Implementation of the DSA"><div class="titlepage"><div><div><h3 class="title"><a name="_implementation_of_the_dsa"></a>4.2.3.&nbsp;Implementation of the DSA</h3></div></div></div><p>In this tutorial, the implementation of the functions is simple. The <span class="emphasis"><em>execute</em></span> function increments the <span class="emphasis"><em>currentExecCycle</em></span> of a block until its value is inferior to the <span class="emphasis"><em>cycles</em></span> value.</p><p>The source code is available through
<a class="link" href="SigPML/files/sigpmlAspects.xtend" target="_top">Kermeta 3 aspects</a>
and showed below</p><a name="sigpmlAspects.xtendExample"></a><pre class="programlisting"><b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">package</b> sigpml.aspects

<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">import</b> fr.inria.diverse.k3.al.annotationprocessor.Aspect
<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">import</b> sigpml.Application
<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">import</b> sigpml.Block
<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">import</b> sigpml.Connector


<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color: darkred">@Aspect(className=Application)</b>
<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">class</b> ApplicationAspect {

}

<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color: darkred">@Aspect(className=Block)</b>
<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">class</b> BlockAspect {
	<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">public</b> <b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">int</b> currentExecCycle = <span class="hl-number">0</span>

	<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">def</b> <b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">public</b> <b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">void</b> execute() {
		<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">if</b> ( <b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">_self</b>.currentExecCycle &lt; <b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">_self</b>.cycles )
			<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">_self</b>.currentExecCycle = <b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">_self</b>.currentExecCycle + <span class="hl-number">1</span>
		<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">else</b>
			<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">_self</b>.currentExecCycle = <span class="hl-number">0</span>
		println(<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">_self</b>.name + <i xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color:blue" class="hl-string">"\n      execute ("</i> + <b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">_self</b>.currentExecCycle + <i xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color:blue" class="hl-string">")"</i> )
	}
}

<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color: darkred">@Aspect(className=Connector)</b>
<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">class</b> ConnectorAspect {

}</pre><p>You must remove the aspects reference in the Melange file.</p><p><span class="inlinemediaobject"><img src="./SigPML/images/sigpml/RemovingImportAspectInMelange.png" alt="Updating the Melange file"></span></p></div></div><div class="section" title="4.3.&nbsp;MoCCML definition"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_moccml_definition"></a>4.3.&nbsp;MoCCML definition</h2></div></div></div><div class="section" title="4.3.1.&nbsp;Creating the MoCCML project"><div class="titlepage"><div><div><h3 class="title"><a name="_creating_the_moccml_project"></a>4.3.1.&nbsp;Creating the MoCCML project</h3></div></div></div><p>From the xDSML project, we select the associated wizard of the MoCC definition that helps to create the moCCML project. On the right click on the Melange file, select the menu "Create MoCC Library for language"&#8594;select the name of the language project&#8594;next&#8594;finish</p><p title="MoCCML project creation"><b>MoCCML project creation.&nbsp;</b><span class="inlinemediaobject"><img src="./SigPML/images/sigpml/MoCCProjectCreation.png" alt="MoCCML project creation"></span></p><p>In the resulting project, we have a directory <span class="emphasis"><em>mocc</em></span> with the <span class="emphasis"><em>MoCCML</em></span> file.</p></div><div class="section" title="4.3.2.&nbsp;Implementation of the MoCCML"><div class="titlepage"><div><div><h3 class="title"><a name="_implementation_of_the_moccml"></a>4.3.2.&nbsp;Implementation of the MoCCML</h3></div></div></div><p>In the MoCCML program, we define the constraint relation which will be referenced in the ECL program (in our case, the <span class="emphasis"><em>ConnectorSDF_PAM</em></span> relation). This relation is based on an automaton definition.</p><p>This automaton describes how the events and variables are used to define a constraint automaton relative to each instance of the <span class="emphasis"><em>Connector</em></span> class.</p><p>The source code is available through
<a class="link" href="SigPML/files/Sigpmltuto.moccml" target="_top">the MoCCML program</a>
and showed below</p><pre class="screen">Unresolved directive in Tutorial_SigPML.asciidoc - include::SigPML/files/xSigpml.moccml[source code of the MocCCML program]</pre><p>Now, we can visualize and edit if necessary the resulting MoCCML automaton. Switch to the modeling perspective (right high corner) and associted the nature modeling to the project (right click on the project&#8594;menu configure&#8594;Convert to modeling project).
We set the MoCCML viewpoint definition on the project (right click on the project&#8594;Viewpoints selection&#8594;select MoCCML viewpoint).</p><p>To visualize the state machine, unfold the SigpmlTuto.moccml&#8594;select the State Relation based library for SigpmlTuto&#8594;new representation.</p><p title="MoCCML diagram for the state based relation definition"><b>MoCCML diagram for the state based relation definition.&nbsp;</b><span class="inlinemediaobject"><img src="./SigPML/images/sigpml/MoCCMLGeneratedDiagram.png" alt="MoCCML diagram for the state based relation definition"></span></p><p>To visualize the state machine, select the <span class="emphasis"><em>ConnectorSDF_PAM_Def</em></span> block and on the right click slect new&#8594;state based diagram.</p><p title="MoCCML state machine definition"><b>MoCCML state machine definition.&nbsp;</b><span class="inlinemediaobject"><img src="./SigPML/images/sigpml/MoCCAutomataLib.png" alt="MoCCML state machine definition"></span></p><p>In this editor, two layers are defined to have the state machine without the transition code, and the other layer "Detailed Transition Layer" add the transition code in the diagram. In this example, we have a state machine with an initial state, a state and three transition with the associated code (<span class="emphasis"><em>when</em></span> clause with the specified clocks, an <span class="emphasis"><em>if</em></span> condition with an expression on variables and an action code after the <span class="emphasis"><em>/</em></span> )</p><p>After the MoCCML definition we define the mapping between this MoCC definition and the abstract syntax of our SigpmlTuto language.</p></div></div><div class="section" title="4.4.&nbsp;DSE definition"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_dse_definition"></a>4.4.&nbsp;DSE definition</h2></div></div></div><p>The DSE definition is related to declare the Domain Specific Events which define the event interface of our language.</p><p>The two sections DSE and MoCC definitions are tightly coupled. So you can create the two projects and iterate between the two projects in progress.</p><div class="section" title="4.4.1.&nbsp;Creating the ECL project"><div class="titlepage"><div><div><h3 class="title"><a name="_creating_the_ecl_project"></a>4.4.1.&nbsp;Creating the ECL project</h3></div></div></div><p>From the xDSML project, we select the associated wizard of the DSE definition. Select the name of <span class="emphasis"><em>SigpmlTuto.melange</em></span> on the right click&#8594; Create DSE project for language &#8594;select the SigpmlTuto language&#8594;ok</p><p title="DSE project creation"><b>DSE project creation.&nbsp;</b><span class="inlinemediaobject"><img src="./SigPML/images/sigpml/createECLProject.png" alt="ECL project creation"></span></p><p>The DSE wizard helps to select the root model element, in our case the <span class="emphasis"><em>Application</em></span> and finish.</p><p title="DSE wizard"><b>DSE wizard.&nbsp;</b><span class="inlinemediaobject"><img src="./SigPML/images/sigpml/DSE-Wizard.png" alt="ECL wizard"></span></p></div><div class="section" title="4.4.2.&nbsp;Implementation of the ECL"><div class="titlepage"><div><div><h3 class="title"><a name="_implementation_of_the_ecl"></a>4.4.2.&nbsp;Implementation of the ECL</h3></div></div></div><p>An ECL program defines the mapping between the domain model, including ED and EF, and the MoCC definition of the previous section.
In this program, you declare the metaclasses that you want to select ED or EF, and associating them with a MoCC definition.</p><p>A metaclass is referenced as <span class="emphasis"><em>Context</em></span> and in this scope we define an event relative to the EF and also invariants that must be satisfied in the context of the metaclasse.</p><p>In this tutorial, two contexts are declared for the metaclasses <span class="emphasis"><em>Block</em></span> and <span class="emphasis"><em>Connector</em></span>.
In the context of <span class="emphasis"><em>Block</em></span> an event <span class="emphasis"><em>execute</em></span> is defined relative to the execution function of the same name in the <span class="emphasis"><em>Block</em></span> metaclass.
In the context of <span class="emphasis"><em>Connector</em></span>, an invariant is declared based on the call of the relation declaration defined previously in the MoCCML model. The arguments of this relation are associated to the attributes of the metaclasses <span class="emphasis"><em>Connector</em></span> and also we can access by navigation expression to the others <span class="emphasis"><em>Ports</em></span> (for the <span class="emphasis"><em>rate</em></span> attribute) and <span class="emphasis"><em>Block</em></span> (for the <span class="emphasis"><em>execute</em></span> EF).</p><p>The source code is available through
<a class="link" href="SigPML/files/SigpmlTuto.ecl" target="_top">the ECL program</a>
and showed below</p><pre class="programlisting"><b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">import</b> 'platform:/resource/org.gemoc.sigpmldomain/model/sigpmldomain.ecore'
--<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">import</b> './sigpmldomain.ecore'
<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">ECLimport</b> <i xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color:blue" class="hl-string">"platform:/resource/org.gemoc.sigpmltuto.mocc/mocc/Sigpmltuto.moccml"</i>
<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">ECLimport</b> <i xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color:blue" class="hl-string">"platform:/plugin/fr.inria.aoste.timesquare.ccslkernel.model/ccsllibrary/kernel.ccslLib"</i>
<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">ECLimport</b> <i xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color:blue" class="hl-string">"platform:/plugin/fr.inria.aoste.timesquare.ccslkernel.model/ccsllibrary/CCSL.ccslLib"</i>


<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">package</b> sigpml

	<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">context</b> Block
		<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">def</b> : execute : <b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">Event</b> = <b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">self</b>.execute()

	<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">context</b> Connector
		<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">inv</b> ConnectorComputing:
			<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">let</b> capacity : <b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">Integer</b> = <b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">self</b>.oclAsType(Connector).capacity <b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">in</b>
		 	<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">let</b> inRate : <b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">Integer</b> = <b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">self</b>.itsInputPort.oclAsType(Port).rate <b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">in</b>
		 	<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">let</b> outRate : <b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">Integer</b> = <b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">self</b>.itsOutputPort.oclAsType(Port).rate <b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">in</b>
		 	<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">let</b> currentSize : <b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">Integer</b> = <b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">self</b>.oclAsType(Connector).currentSize <b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">in</b>

		 <b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">Relation</b> ConnectorSDF_PAM (
				<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">self</b>.itsOutputPort.oclAsType(OutputPort).owner.oclAsType(Block).execute,
				<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">self</b>.itsInputPort.oclAsType(InputPort).owner.oclAsType(Block).execute,
				capacity,
				inRate,
				outRate,
				currentSize
			)

<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">endpackage</b>

--<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">import</b> './sigpmldomain.ecore'
--<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">ECLimport</b> <i xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color:blue" class="hl-string">"./xSigpml.moccml"</i>
--<b xmlns:fo="http://www.w3.org/1999/XSL/Format" class="hl-keyword" style="color:darkblue">ECLimport</b> <i xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color:blue" class="hl-string">"./Sigpmltuto.moccml"</i></pre><p title="ECL Implemenattion"><b>ECL Implemenattion.&nbsp;</b><span class="inlinemediaobject"><img src="./SigPML/images/sigpml/ECL_Implementation.png" alt="ECL Implementation"></span></p><p>At the end of this step the SigPML language is completely in terms of the metamodel, the graphical syntax, the behavior code of the functions, the expression of the concurrent semantics and the mapping between them.</p><p>The last step is to define the animation view of the models as a debug extension of the graphical syntax.</p></div></div><div class="section" title="4.5.&nbsp;Create an animator"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_create_an_animator"></a>4.5.&nbsp;Create an animator</h2></div></div></div><div class="section" title="4.5.1.&nbsp;Creating the Animator project as a Sirius viewpoint"><div class="titlepage"><div><div><h3 class="title"><a name="_creating_the_animator_project_as_a_sirius_viewpoint"></a>4.5.1.&nbsp;Creating the Animator project as a Sirius viewpoint</h3></div></div></div><p>As the section dedicated to the graphical syntax, the animator is defined as a Sirius viewpoint based on
<a class="link" href="SigPML/files/Sigpmltutodebug.odesign" target="_top">the odesign file</a></p><p>To create a debug viewpoint, on the Melange file we select "Create Animator Project for language"&#8594;select the language name&#8594;Extends an existing diagram description (as the next picture).</p><p title="Create a debug representation."><b>Create a debug representation.&nbsp;</b><span class="inlinemediaobject"><img src="./SigPML/images/sigpml/CreateDebugLayer.png" alt="Create a debug representation"></span></p><p>Now a Sirius project is created with a file odesign in the description folder. Open the odesign file and on a right click select "Load ressource" and select the odesign file of the the initial graphical syntax as in the next picture.</p><p title="Select the odesign ressource."><b>Select the odesign ressource.&nbsp;</b><span class="inlinemediaobject"><img src="./SigPML/images/sigpml/LoadRessourceSelectOdesign.png" alt="Select the odesign ressource"></span></p><p>Now we edit the odesign file and customizing the debug layer.
Open the Debug layer and add Style cuistomizations as the next picture.</p><p title="Adding Style customization."><b>Adding Style customization.&nbsp;</b><span class="inlinemediaobject"><img src="./SigPML/images/sigpml/AddStyleCustomization.png" alt="Adding Style customization"></span></p><p>On this style, we add a property customization to change the label of the Block in our future model.</p><p title="Adding Property customization."><b>Adding Property customization.&nbsp;</b><span class="inlinemediaobject"><img src="./SigPML/images/sigpml/AddPropertyCustomizationByExpression.png" alt="Adding Property customization"></span></p><p>We fill the properties of this element. First the field AppliedOn to select the graphical element of the Block (Square light_chocolate).</p><p title="Select Graphical element."><b>Select Graphical element.&nbsp;</b><span class="inlinemediaobject"><img src="./SigPML/images/sigpml/AppliedOnSquareChocolate.png" alt="Select Graphical element"></span></p><p>Fill the next fileds like the next picture.
.Property Customization.
<span class="inlinemediaobject"><img src="./SigPML/images/sigpml/CustomizeByExpression.png" alt="Property Customization"></span></p><p>We add another style customization and fill the predicate expression as the next picture.
.Second Style Customization
<span class="inlinemediaobject"><img src="./SigPML/images/sigpml/SecondStyleCustomization.png" alt="Second Style Customization"></span></p><p>On this style, we add a property customization (by expression) to change the block color under the previous condition when the <span class="emphasis"><em>currentExecCycle &gt; 0</em></span></p><p title="Adding Property customization."><b>Adding Property customization.&nbsp;</b><span class="inlinemediaobject"><img src="./SigPML/images/sigpml/PropertyCustomizationBySelection.png" alt="Adding Property customization"></span></p><p>For now the language is totaly defined and executable, so we can used the SigPML Language !!</p></div></div></div><div class="chapter" title="Chapter&nbsp;5.&nbsp;SigPML modeling workbench"><div class="titlepage"><div><div><h2 class="title"><a name="_sigpml_modeling_workbench"></a>Chapter&nbsp;5.&nbsp;SigPML modeling workbench</h2></div></div></div><p>From the language workbench, the Sigpml modeling workbench can be used to create a model and execute it.</p><div class="section" title="5.1.&nbsp;Launch the Modeling workbench creation (Start a new Eclipse)"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_launch_the_modeling_workbench_creation_start_a_new_eclipse"></a>5.1.&nbsp;Launch the Modeling workbench creation (Start a new Eclipse)</h2></div></div></div><p>To launch the modeling workbench dedicated to the Sigpml language, we create an eclipse apllication configuration to run the gemocstudio associated with the xDSML definition.
The current parameters are set conforming to the parameters of the next picture.</p><p title="Modeling Workbench launching"><b>Modeling Workbench launching.&nbsp;</b><span class="inlinemediaobject"><img src="./SigPML/images/sigpml/CreateModelingWorkbench.png" alt="Modeling Workbench launching"></span></p><p>To obtain modeling workbench adequate performances, we set the VM parameters in the <span class="emphasis"><em>Arguments</em></span> tab to</p><pre class="screen">-Xmx3000m
-Xms3000m</pre></div><div class="section" title="5.2.&nbsp;Import the project with a sample model"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_import_the_project_with_a_sample_model"></a>5.2.&nbsp;Import the project with a sample model</h2></div></div></div><p>First you create a sigpml model or you can install the given model in an eclipse project
<a class="link" href="SigPML/files/SigpmlModelingTuto.zip" target="_top">The modeling project</a>.</p></div><div class="section" title="5.3.&nbsp;Create a debug launch configuration"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_create_a_debug_launch_configuration"></a>5.3.&nbsp;Create a debug launch configuration</h2></div></div></div><p>To execute a model, we create a debug configuration and set the parameters conforming to the picture <a class="xref" href="#debugLaunching" title="The debug launching configuration">The debug launching configuration</a>.</p><p title="The debug launching configuration"><a name="debugLaunching"></a><b>The debug launching configuration.&nbsp;</b><span class="inlinemediaobject"><img src="./SigPML/images/sigpml/DebugLaunchingConfiguration.png" alt="The debug launching configuration"></span></p><p>In this configuration, we select the step by step execution with user selection for the next logical step.</p></div><div class="section" title="5.4.&nbsp;Start the model"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_start_the_model"></a>5.4.&nbsp;Start the model</h2></div></div></div><p>When the model is executing, the overview of the modeling workbench is presented in the next picture.</p><p title="The executed Sigpml model"><b>The executed Sigpml model.&nbsp;</b><span class="inlinemediaobject"><img src="./SigPML/images/sigpml/OverviewExecuteSigpmlModel.png" alt="The executed Sigpml model"></span></p><p>The views are extended with the VCD view which presents all the clocks define in the MoccML model with a tick clock during the logical steps.</p><p title="The Sigpml model with a VCD view"><b>The Sigpml model with a VCD view.&nbsp;</b><span class="inlinemediaobject"><img src="./SigPML/images/sigpml/OverviewExecuteSigpmlModelWithVCD.png" alt="The Sigpml model with a VCD view"></span></p><p>The sigpml model is edited in the model editor and we can select model elements and change the model element properties.</p><p title="The Sigpml model element properties"><b>The Sigpml model element properties.&nbsp;</b><span class="inlinemediaobject"><img src="./SigPML/images/sigpml/sigpmlModelProperties.png" alt="The Sigpml model element properties"></span></p></div><div class="section" title="5.5.&nbsp;Select a logical step"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_select_a_logical_step"></a>5.5.&nbsp;Select a logical step</h2></div></div></div><p>To start the execution of the model, we select a logical step to execute the model in the <span class="emphasis"><em>Concurrent Logical Steps Decider</em></span> in the upper right window. The logical step contains the event <span class="emphasis"><em>MSE\_B1\_execute</em></span> so to select this event the Mocml model activates the <span class="emphasis"><em>execute</em></span> function of the Block <span class="emphasis"><em>B1</em></span>. So the animation view of the model is updated due to the expression defines in the animation viewpoint.</p><p title="Start the Sigpml model"><b>Start the Sigpml model.&nbsp;</b><span class="inlinemediaobject"><img src="./SigPML/images/sigpml/StartExecutionFirstLogicalStep.png" alt="Start the Sigpml model"></span></p><p>After, we select again the logical steps to execute and the model progesses and the exection trace is visualized in the timeline view.
.The Sigpml model trace timeline
<span class="inlinemediaobject"><img src="./SigPML/images/sigpml/ExecutionTraceTimeline.png" alt="The Sigpml model trace timeline"></span></p></div><div class="section" title="5.6.&nbsp;Select a logical step in the past"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_select_a_logical_step_in_the_past"></a>5.6.&nbsp;Select a logical step in the past</h2></div></div></div><p>We can select a logical step from the past in the timeline, to retstart the execution from this logical step.
In this case, a branch appears in the timeline view and we continue the logical step selection.
.Timeline branches after backwards
<span class="inlinemediaobject"><img src="./SigPML/images/sigpml/TimelineBranches.png" alt="Timeline branches after backwards"></span></p></div><div class="section" title="5.7.&nbsp;Stop the animation"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_stop_the_animation"></a>5.7.&nbsp;Stop the animation</h2></div></div></div><p>To stop the animation, we select the red button in the <span class="emphasis"><em>Gemoc engines status</em></span> view or in the <span class="emphasis"><em>Concurrent Logical Steps Decider</em></span>.</p></div><div class="section" title="5.8.&nbsp;This is the end"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_this_is_the_end"></a>5.8.&nbsp;This is the end</h2></div></div></div><p>At this step, we have described all the basic possibilities of the Gemoc studio on this tutorial.</p></div></div></div></body></html>